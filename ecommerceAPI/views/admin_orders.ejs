<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Check orders (Admin)</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="/css/style.css" />
  </head>

  <body>
    <header>
      <nav class="navbar navbar-expand-lg bg-dark navbar-dark fixed-top navi">
        <div class="container">
          <a class="navbar-brand name" href="#">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              height="1em"
              viewBox="0 0 576 512"
            >
              <style>
                svg {
                  fill: #ffffff;
                }
              </style>
              <path
                d="M249.6 471.5c10.8 3.8 22.4-4.1 22.4-15.5V78.6c0-4.2-1.6-8.4-5-11C247.4 52 202.4 32 144 32C93.5 32 46.3 45.3 18.1 56.1C6.8 60.5 0 71.7 0 83.8V454.1c0 11.9 12.8 20.2 24.1 16.5C55.6 460.1 105.5 448 144 448c33.9 0 79 14 105.6 23.5zm76.8 0C353 462 398.1 448 432 448c38.5 0 88.4 12.1 119.9 22.6c11.3 3.8 24.1-4.6 24.1-16.5V83.8c0-12.1-6.8-23.3-18.1-27.6C529.7 45.3 482.5 32 432 32c-58.4 0-103.4 20-123 35.6c-3.3 2.6-5 6.8-5 11V456c0 11.4 11.7 19.3 22.4 15.5z"
              />
            </svg>
            TURN THE PAGE
          </a>
          <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
            <li class="nav-item">
              <a class="nav-link berhobo" href="/logout">
                <span>Logout</span>
                <svg
                  class="lout"
                  xmlns="http://www.w3.org/2000/svg"
                  height="1em"
                  viewBox="0 0 512 512"
                >
                  <style>
                    svg.lout {
                      fill: #ffffff;
                      margin-bottom: 0.25rem;
                    }
                  </style>
                  <path
                    d="M502.6 278.6c12.5-12.5 12.5-32.8 0-45.3l-128-128c-12.5-12.5-32.8-12.5-45.3 0s-12.5 32.8 0 45.3L402.7 224 192 224c-17.7 0-32 14.3-32 32s14.3 32 32 32l210.7 0-73.4 73.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l128-128zM160 96c17.7 0 32-14.3 32-32s-14.3-32-32-32L96 32C43 32 0 75 0 128L0 384c0 53 43 96 96 96l64 0c17.7 0 32-14.3 32-32s-14.3-32-32-32l-64 0c-17.7 0-32-14.3-32-32l0-256c0-17.7 14.3-32 32-32l64 0z"
                  />
                </svg>
              </a>
            </li>
          </ul>
        </div>
      </nav>
    </header>

    <main>
      <div class="container my-5">
        <%if(data.length > 0){%>
        <h1 style="text-align: center; padding: 2rem">Check orders</h1>
        <div
          class="d-md-flex d-none justify-content-md-between justify-content-sm-center align-content-center border-bottom border-2 my-2 bg-dark text-light p-3 rounded-3"
        >
          <div class="col-3 align-self-center">
            <h1 class="h5 fw-bold text-center">Order Info</h1>
          </div>
          <div class="col-3 align-self-center">
            <h1 class="h5 fw-bold text-center">Shipping Info</h1>
          </div>
          <div class="col-4 align-self-center">
            <h1 class="h5 fw-bold text-center">Items ordered</h1>
          </div>
          <div class="col-2 align-self-center">
            <h1 class="h5 fw-bold text-center">Order Status</h1>
          </div>
        </div>
        <%data.forEach(function(data){%>
        <div
          class="d-md-flex d-sm-block justify-content-md-between justify-content-sm-center text-center border-bottom border-2 my-2 bg-light p-2 rounded-3"
        >
          <div class="col-md-3 text-sm-center align-self-center my-2">
            <h1 class="h6">Order ID: TTP<%=data.id*10+123%></h1>
            <h1 class="h6">Date: <%=data.createdAt%></h1>
            <h1 class="h6">Order Amount: BDT <%=data.total%></h1>
          </div>

          <div class="col-md-3 text-sm-center align-self-center my-2">
            <h1 class="h6">Name: <%=data.user_name%></h1>
            <h1 class="h6">Address: <%=data.address%></h1>
          </div>

          <div class="col-md-4 text-sm-center align-self-center my-2">
            <h1 class="h6"><%=data.description%></h1>
          </div>

          <div class="col-md-2 text-sm-center align-self-center my-2">
            <%if(data.status==='Processing'){%>
            <form
              method="post"
              action="/confirmOrder"
              class="d-flex justify-content-center"
            >
              <input type="hidden" name="id" value="<%=data.id%>" />
              <input
                type="hidden"
                name="total"
                value="<%=data.total%>"
                <div
                class="container"
              />
              <button
                type="button"
                class="btn btn-primary"
                data-bs-toggle="modal"
                data-bs-target="#<%=data.id%>"
              >
                Confirm
              </button>

              <div class="modal fade" id="<%=data.id%>">
                <div
                  class="modal-dialog modal-dialog-centered modal-dialog-scrollable"
                >
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title">
                        Order ID: TTP<%=data.id*10+123%>
                      </h5>
                      <button
                        type="button"
                        class="btn-close"
                        data-bs-dismiss="modal"
                      ></button>
                    </div>
                    <div class="modal-body">
                      <h6>Amount to be paid: BDT <%=data.total%></h6>
                      <h6>
                        Transaction ID:
                        <%=Math.random().toString(36).substr(2)%>
                      </h6>
                      <p><%=data.address%></p>
                      <p>
                        Also <strong>BDT <%=data.total%></strong> will be
                        deducted from your(Admin) bank account.
                      </p>
                    </div>
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn btn-outline-primary"
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                      <button
                        type="submit"
                        class="btn btn-primary"
                        data-bs-dismiss="modal"
                      >
                        Proceed
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </form>
            <%} else{%> <%if(data.status === 'Under Shipping') {%>
            <h1 class="h6 text-primary"><%=data.status%></h1>
            <%} else {%>
            <h1 class="h6 text-success"><%=data.status%></h1>
            <%}%> <%}%>
          </div>
        </div>
        <%}); } else {%>
        <h1 class="text-muted" style="text-align: center; padding: 2rem">
          No orders placed yet
        </h1>
        <%}%>
      </div>
    </main>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
